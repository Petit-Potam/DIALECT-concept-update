<style>
  #shopify-section-{{ section.id }} {
    --text-content-padding: {{ section.settings.text_content_padding_mob }}px;
    --text-background-color: {{ section.settings.text_background_color }};
    --text-color: {{ section.settings.text_color }};
    --button-background-color: {{ section.settings.button_background_color }};
    --button-text-color: {{ section.settings.button_text_color }};
  }

  #shopify-section-{{ section.id }} {
    @media screen and (min-width: 768px) {
      --text-content-padding: {{ section.settings.text_content_padding_dsk }}px;
    }
  }
</style>

{% liquid
  assign desktop_image = section.settings.image_dsk
  assign mobile_image = section.settings.image_mob

  if mobile_image == blank
    assign mobile_image = desktop_image
  endif
%}

<div class="{% if section.settings.section_width == "boxed" %}jc-container{% endif %}">
  <media-element
    {% if section.settings.paralax_enabled %}
      data-parallax="0.3"
    {% endif %}
    class="jc-relative jc-flex jc-flex-col md:jc-flex-row md:jc-p-6 jc-min-h-[400px] jc-overflow-hidden {% if section.settings.section_width == "boxed" %}jc-rounded-lg{% endif %}"
  >
    {% liquid
      assign image_class_dsk = 'jc-absolute jc-inset-0 jc-w-full jc-h-full jc-object-cover jc-hidden md:jc-block'
      if section.settings.section_width == 'boxed'
        assign image_class_dsk = image_class_dsk | append: ' jc-rounded-lg'
      endif
    %}
    {% render 'g-render-image',
      class: image_class_dsk,
      img: desktop_image,
      size: '300 900 2000',
      alt: desktop_image.alt,
      width: desktop_image.width,
      height: desktop_image.height,
      loading: 'eager',
      id: desktop_image.id
    %}

    {% liquid
      assign image_class_mob = 'jc-w-full jc-h-auto jc-object-cover jc-block md:jc-hidden'
      if section.settings.section_width == 'boxed'
        assign image_class_mob = image_class_mob | append: ' jc-rounded-lg'
      endif
    %}
    {% render 'g-render-image',
      class: image_class_mob,
      img: desktop_image,
      size: '300 900 1280',
      alt: desktop_image.alt,
      width: desktop_image.width,
      height: desktop_image.height,
      loading: 'eager',
      id: desktop_image.id
    %}

    {%- unless section.settings.subheading == blank
      and section.settings.heading == blank
      and section.settings.description == blank
    -%}
      <div class="{% if section.settings.section_width == "full" %}jc-mx-auto md:jc-px-15 jc-max-w-[1440px]{% endif %} jc-flex jc-w-full">
        <animate-element
          {% if section.settings.reveal_on_scroll %}
            data-animate="fade-in"
          {% endif %}
          class="jc-relative jc-w-full md:jc-w-1/2 jc-z-[1] jc-rounded-b-md md:jc-rounded-md jc-bg-[var(--text-background-color)] [&_*]:jc-text-[var(--text-color)] jc-p-[var(--text-content-padding)] [&_p]:jc-mt-6 [&_p]:jc-opacity-80"
        >
          {%- if section.settings.subheading != blank -%}
            <h4 class="jc-mb-4 jc-text-base jc-leading-6">{{ section.settings.subheading }}</h4>
          {%- endif -%}

          {%- if section.settings.heading != blank -%}
            <h3 class="jc-text-xl jc-leading-6 jc-font-extrabold jc-tracking-wide jc-my-4">
              {{ section.settings.heading }}
            </h3>
          {%- endif -%}

          {%- if section.settings.description != blank -%}
            {{ section.settings.description }}
          {%- endif -%}

          {%- if section.settings.button_text != blank -%}
            <a href="{{ section.settings.button_link }}">
              <button
                type="submit"
                class="button button--primary jc-uppercase after:!jc-hidden jc-border jc-border-[var(--button-background-color)] jc-border-solid [&:not(:hover)]:!jc-text-[var(--button-text-color)] !jc-bg-[var(--button-background-color)] jc-rounded-md jc-mt-4 md:jc-mt-8"
                is="hover-button"
              >
                <span
                  class="btn-fill"
                  data-fill=""
                  style="transform: translateY(var(--motion-translateY)); --motion-translateY: -76%;"
                ></span>
                <span class="btn-text">{{ section.settings.button_text }}</span>
                <span class="btn-loader">
                  <span></span>
                  <span></span>
                  <span></span>
                </span>
              </button>
            </a>
          {%- endif -%}
        </animate-element>
      </div>
    {%- endunless -%}
  </media-element>
</div>

{% schema %}
{
  "name": "Image with animated text",
  "settings": [
    {
      "type": "checkbox",
      "id": "reveal_on_scroll",
      "label": "Reveal on scroll",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "paralax_enabled",
      "label": "Background image parallax",
      "default": true
    },
    {
      "type": "range",
      "id": "text_content_padding_dsk",
      "min": 0,
      "max": 80,
      "step": 1,
      "unit": "px",
      "label": "Text content padding (desktop)",
      "default": 64
    },
    {
      "type": "range",
      "id": "text_content_padding_mob",
      "min": 0,
      "max": 80,
      "step": 1,
      "unit": "px",
      "label": "Text content padding (mobile)",
      "default": 24
    },
    {
      "type": "image_picker",
      "id": "image_dsk",
      "label": "Desktop image"
    },
    {
      "type": "image_picker",
      "id": "image_mob",
      "label": "Mobile image"
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "Subheading",
      "default": "Subheading"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Heading"
    },
    {
      "type": "richtext",
      "id": "description",
      "label": "Description",
      "default": "<p>Default description</p>"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button text",
      "default": "Button text"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "Button link"
    },
    {
      "type": "select",
      "id": "section_width",
      "label": "Section width",
      "options": [
        {
          "value": "boxed",
          "label": "Boxed"
        },
        {
          "value": "full",
          "label": "Full"
        }
      ],
      "default": "boxed"
    },
    {
      "type": "header",
      "content": "ðŸŽ¨ Design"
    },
    {
      "type": "color",
      "id": "text_background_color",
      "label": "Text background",
      "default": "#FFF"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text color",
      "default": "#000"
    },
    {
      "type": "color",
      "id": "button_background_color",
      "label": "Button background",
      "default": "#000"
    },
    {
      "type": "color",
      "id": "button_text_color",
      "label": "Button text",
      "default": "#FFF"
    }
  ],
  "presets": [
    {
      "name": "Image with animated text"
    }
  ]
}
{% endschema %}
