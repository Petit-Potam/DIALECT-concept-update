function c(l,e){const i=[];for(let t in l){if(!l.hasOwnProperty(t))continue;const s=l[t],n=encodeURIComponent(t);let r;typeof s=="object"?Array.isArray(s)?r=s.map(h=>c(h,e?`${e}[${n}][]`:`${n}[]`)).join("&"):r=c(s,e?`${e}[${n}]`:n):r=(e?`${e}[${n}]`:n)+"="+encodeURIComponent(s),i.push(r)}return i.join("&")}async function o(l,e){let i;return fetch(window.Shopify.routes.root+`search/suggest?${c(l)}`).then(t=>(i=t,t.text())).then(t=>{if(!i.ok)throw new Error(`${i.status}: ${t}`);e.forEach(s=>{const n=new DOMParser().parseFromString(t,"text/html").querySelector(s).innerHTML;document.querySelector(s).innerHTML=n})}).catch(t=>{console.error(t)})}const u={suggest:o};class a extends HTMLElement{constructor(){super(),this.elements={inputText:this.querySelector("input"),displayResultBlock:this.querySelector("#blog-search-result"),sectionId:"ajax-search-articles",renderingResultSelectors:["#blog-search-result"],hideButton:this.querySelector(".js-search-hide")},this.elements.inputText.addEventListener("keyup",this.getSearchArticles.bind(this)),this.elements.inputText.addEventListener("click",this.getSearchArticles.bind(this)),this.elements.inputText.addEventListener("focusout",this.hideResults.bind(this)),this.elements.hideButton.addEventListener("click",this.hideResults.bind(this))}async getSearchArticles(e){const i=e.key==="Escape";if(this.elements.inputText.value.trim()==""||e.key==="Escape"){this.hideResults(i);return}const t=await u.suggest({q:this.elements.inputText.value.trim(),resources:{type:"article"},section_id:this.elements.sectionId},this.elements.renderingResultSelectors);new DOMParser().parseFromString(t,"text/html").querySelector(this.elements.renderingResultSelectors[0])?this.showResults():this.hideResults()}hideResults(e){this.elements.displayResultBlock.classList.add("jc-opacity-0","jc-invisible"),this.elements.displayResultBlock.style.height="0",this.elements.hideButton.classList.add("jc-hidden"),this.elements.inputText.style.paddingRight="",e&&this.elements.inputText.blur()}showResults(){this.elements.displayResultBlock.classList.remove("jc-opacity-0","jc-invisible"),this.elements.displayResultBlock.style.height=this.elements.displayResultBlock.querySelector("ul").offsetHeight+"px",this.elements.hideButton.classList.remove("jc-hidden"),this.elements.inputText.style.paddingRight="50px"}}customElements.define("blog-search",a);
